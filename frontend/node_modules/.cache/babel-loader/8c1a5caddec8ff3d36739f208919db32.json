{"ast":null,"code":"import _slicedToArray from \"/Users/saracarlstein/project-auth/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/saracarlstein/project-auth/frontend/src/components/Login.js\";\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch, batch } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Container from '@material-ui/core/Container';\nimport user from '../reducers/user';\nimport { API_URL } from '../reusables/urls';\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center'\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main\n  },\n  form: {\n    width: '100%',\n    // Fix IE 11 issue.\n    marginTop: theme.spacing(1)\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  }\n}));\n\nconst Login = () => {\n  const classes = useStyles();\n\n  const _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        username = _useState2[0],\n        setUsername = _useState2[1];\n\n  const _useState3 = useState(''),\n        _useState4 = _slicedToArray(_useState3, 2),\n        password = _useState4[0],\n        setPassword = _useState4[1];\n\n  const _useState5 = useState(null),\n        _useState6 = _slicedToArray(_useState5, 2),\n        mode = _useState6[0],\n        setMode = _useState6[1];\n\n  const accessToken = useSelector(store => store.user.accessToken);\n  const dispatch = useDispatch();\n  const history = useHistory();\n  useEffect(() => {\n    // redirect user to '/' path\n    // everytime access token is changed, it will be pushed '/'\n    console.log('Checking access token', accessToken);\n\n    if (accessToken) {\n      history.push('/questions');\n    }\n  }, [accessToken, history]);\n\n  const onFormSubmit = e => {\n    e.preventDefault();\n    const options = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    };\n    fetch(API_URL(mode), options).then(res => res.json()).then(data => {\n      console.log(data);\n\n      if (data.success) {\n        // updating dispatch at the same time \n        batch(() => {\n          dispatch(user.actions.setUsername(data.username));\n          dispatch(user.actions.setAccessToken(data.accessToken));\n          dispatch(user.actions.setErrors(null));\n        });\n      } else {\n        dispatch(user.actions.setErrors(data));\n      }\n    }).catch();\n  };\n\n  return React.createElement(\"div\", {\n    className: classes.background,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, React.createElement(Container, {\n    component: \"main\",\n    maxWidth: \"xs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: classes.paper,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, React.createElement(Avatar, {\n    className: classes.avatar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }), React.createElement(Typography, {\n    component: \"h1\",\n    variant: \"h5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, \"Sign in\"), React.createElement(\"form\", {\n    onSubmit: onFormSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    id: \"email\",\n    label: \"Email Address\",\n    name: \"email\",\n    autoComplete: \"email\",\n    autoFocus: true,\n    type: \"text\",\n    value: username,\n    onChange: e => setUsername(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }), React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    name: \"password\",\n    label: \"Password\",\n    type: \"password\",\n    id: \"password\",\n    autoComplete: \"current-password\",\n    type: \"password\",\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }), React.createElement(Button, {\n    type: \"submit\",\n    fullWidth: true,\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.submit,\n    type: \"submit\",\n    onClick: () => setMode('signin'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"Sign in\"), React.createElement(Button, {\n    type: \"submit\",\n    fullWidth: true,\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.submit,\n    type: \"submit\",\n    onClick: () => setMode('signup'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, \"Sign up\")))));\n};\n\nexport default Login;","map":{"version":3,"sources":["/Users/saracarlstein/project-auth/frontend/src/components/Login.js"],"names":["React","useState","useEffect","useSelector","useDispatch","batch","useHistory","Avatar","Button","TextField","Typography","makeStyles","Container","user","API_URL","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","Login","classes","username","setUsername","password","setPassword","mode","setMode","accessToken","store","dispatch","history","console","log","push","onFormSubmit","e","preventDefault","options","method","headers","body","JSON","stringify","fetch","then","res","json","data","success","actions","setAccessToken","setErrors","catch","background","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch, batch } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\n\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Container from '@material-ui/core/Container';\n\nimport user from '../reducers/user';\n\nimport { API_URL } from '../reusables/urls';\n\n\nconst useStyles = makeStyles((theme) => ({\n    paper: {\n      marginTop: theme.spacing(8),\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n    },\n    avatar: {\n      margin: theme.spacing(1),\n      backgroundColor: theme.palette.secondary.main,\n    },\n    form: {\n      width: '100%', // Fix IE 11 issue.\n      marginTop: theme.spacing(1),\n    },\n    submit: {\n      margin: theme.spacing(3, 0, 2),\n    },\n  }));\n\nconst Login = () => {\n    const classes = useStyles();\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [mode, setMode] = useState(null);\n\n    const accessToken = useSelector(store => store.user.accessToken);\n    const dispatch = useDispatch();\n    const history = useHistory();\n\n    useEffect(() => {\n        // redirect user to '/' path\n        // everytime access token is changed, it will be pushed '/'\n        console.log('Checking access token', accessToken);\n        if (accessToken) {\n            history.push('/questions');\n        }\n    }, [accessToken, history]);\n\n    const onFormSubmit = (e) => {\n        e.preventDefault();\n\n        const options = {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ username, password })\n        }\n        fetch(API_URL(mode), options)\n            .then(res => res.json())\n            .then(data => {\n                console.log(data);\n                if (data.success) {\n                    // updating dispatch at the same time \n                    batch(() => {\n                        dispatch(user.actions.setUsername(data.username));\n                        dispatch(user.actions.setAccessToken(data.accessToken));\n                        dispatch(user.actions.setErrors(null));\n                    });\n                } else {\n                    dispatch(user.actions.setErrors(data));\n                }\n            })\n            .catch();\n    };\n\n    return (\n    <div className={classes.background}>\n        <Container component=\"main\" maxWidth=\"xs\">\n            <div className={classes.paper}>\n            <Avatar className={classes.avatar}>\n            {/* <LockOutlinedIcon /> */}\n            </Avatar>\n            <Typography component=\"h1\" variant=\"h5\">\n            Sign in\n            </Typography>\n                <form onSubmit={onFormSubmit}>\n                <TextField\n                    variant=\"outlined\"\n                    margin=\"normal\"\n                    required\n                    fullWidth\n                    id=\"email\"\n                    label=\"Email Address\"\n                    name=\"email\"\n                    autoComplete=\"email\"\n                    autoFocus\n                    type=\"text\"\n                    value={username}\n                    onChange={(e) => setUsername(e.target.value)}\n                    />\n                <TextField\n                    variant=\"outlined\"\n                    margin=\"normal\"\n                    required\n                    fullWidth\n                    name=\"password\"\n                    label=\"Password\"\n                    type=\"password\"\n                    id=\"password\"\n                    autoComplete=\"current-password\"\n                    type=\"password\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                />\n                <Button \n                    type=\"submit\"\n                    fullWidth\n                    variant=\"contained\"\n                    color=\"primary\"\n                    className={classes.submit}\n                    type=\"submit\" \n                    onClick={() => setMode('signin')}>Sign in</Button>\n                <Button \n                    type=\"submit\"\n                    fullWidth\n                    variant=\"contained\"\n                    color=\"primary\"\n                    className={classes.submit}\n                    type=\"submit\" \n                    onClick={() => setMode('signup')}>Sign up</Button>\n                </form>\n            </div>\n        </Container>\n    </div>\n    );\n};\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}